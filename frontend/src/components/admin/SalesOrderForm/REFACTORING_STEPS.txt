QUICK REFACTORING STEPS FOR Step4_MaterialRequirement.jsx
===========================================================

Due to file size limitations, here are the manual steps to complete the refactoring:

STEP 1: UPDATE IMPORTS (Lines 1-27)
====================================
Replace the entire import block with:

```javascript
import React from "react";
import { Package, Plus, Trash2, Edit2, X, FileText, Save } from "lucide-react";
import Input from "../../../ui/Input";
import FormSection from "../shared/FormSection";
import FormRow from "../shared/FormRow";
import Modal from "../../../ui/Modal";
import Button from "../../../ui/Button";
import { useFormData, useSalesOrderContext } from "../hooks";
import { useMaterialForm } from "../hooks/useMaterialForm";
import { useMaterialModal } from "../hooks/useMaterialModal";
import MaterialTable from "../components/MaterialTable";
import {
  materialUnits,
  materialSources,
  STEEL_SECTION_CATEGORY_FIELDS,
  PLATE_CATEGORY_FIELDS,
} from "../constants/materialConstants";
import {
  MACHINED_PARTS_SPECS,
  MACHINED_PARTS_SPECIFIC_FIELDS,
  ROLLER_MOVEMENT_COMPONENTS_SPECS,
  ROLLER_MOVEMENT_COMPONENTS_SPECIFIC_FIELDS,
  LIFTING_PULLING_MECHANISMS_SPECS,
  ELECTRICAL_AUTOMATION_SPECS,
  SAFETY_MATERIALS_SPECS,
  SURFACE_PREP_PAINTING_SPECS,
  FABRICATION_CONSUMABLES_SPECS,
  HARDWARE_MISC_SPECS,
  DOCUMENTATION_MATERIALS_SPECS,
  STEEL_SECTIONS_SPECS,
  PLATE_TYPES_SPECS,
  MATERIAL_GRADES_SPECS,
  MATERIAL_GRADE_SPECIFIC_FIELDS,
  FASTENER_TYPES_SPECS,
  FASTENER_SPECIFIC_FIELDS,
} from "../constants";
```

STEP 2: DELETE CONSTANTS (Lines 29-98)
=======================================
DELETE these lines:
- const materialUnits = [ ... ] (lines 29-36)
- const materialSources = [ ... ] (lines 38-42)
- const STEEL_SECTION_CATEGORY_FIELDS = { ... } (lines 44-74)
- const PLATE_CATEGORY_FIELDS = { ... } (lines 76-98)

These are now imported from "../constants/materialConstants"

STEP 3: REPLACE COMPONENT FUNCTION SIGNATURE & HOOKS (Lines 100-215)
=====================================================================
Replace:
```javascript
export default function Step4_MaterialRequirement() {
  const { formData, updateField } = useFormData();
  const {
    state,
    toggleMaterialType,
    updateMaterialDetail,
    deleteMaterialDetail,
  } = useSalesOrderContext();

  const [currentMaterial, setCurrentMaterial] = useState({...});
  const [specModalOpen, setSpecModalOpen] = useState(false);
  const [specModalType, setSpecModalType] = useState(null);
  const [editingDetail, setEditingDetail] = useState(null);
  const [viewModalOpen, setViewModalOpen] = useState(false);
  const [viewingMaterial, setViewingMaterial] = useState(null);
```

With:
```javascript
export default function Step4_MaterialRequirement() {
  const { formData, updateField } = useFormData();
  const {
    state,
    toggleMaterialType,
    updateMaterialDetail,
    deleteMaterialDetail,
  } = useSalesOrderContext();

  const {
    currentMaterial,
    setCurrentMaterial,
    editingDetail,
    setEditingDetail,
    handleMaterialChange,
    addMaterial,
    removeMaterial,
    editMaterial,
    updateMaterial,
    resetMaterial,
  } = useMaterialForm(openSpecModal, updateField, formData);

  const {
    specModalOpen,
    setSpecModalOpen,
    specModalType,
    setSpecModalType,
    viewModalOpen,
    setViewModalOpen,
    viewingMaterial,
    setViewingMaterial,
    openSpecModal,
    closeSpecModal,
    getSpecsForType,
    handleDetailSubmit,
  } = useMaterialModal(setCurrentMaterial);
```

STEP 4: DELETE FUNCTION DEFINITIONS (Lines 220-434)
====================================================
DELETE these function definitions (they're now in the hooks):
- toggleEnabledMaterial() - line 220-222
- handleMaterialChange() - line 224-243
- addMaterial() - line 245-251
- removeMaterial() - line 253-258
- editMaterial() - line 260-263
- updateMaterial() - line 265-274
- resetMaterial() - line 276-379
- openSpecModal() - line 381-384
- closeSpecModal() - line 386-389
- getSpecsForType() - line 391-404
- handleDetailSubmit() - line 406-434

Keep these:
- enabledMaterials and materialDetailsTable variable assignments (line 217-218)
- renderCommonFields() function (line 436-474) - still needed for inline rendering

STEP 5: REPLACE MATERIAL TABLE (Around line 1008-1184)
=======================================================
Find the section that starts with:
```javascript
{formData.materials.length > 0 && (
  <div className="mt-8">
    <h5 className="text-lg font-semibold text-slate-200 mb-4">
      Material Requirements Table
    </h5>
    <div className="overflow-x-auto bg-slate-800 rounded-lg border border-slate-700">
      <table className="w-full text-sm">
```

Replace the entire table rendering with:
```javascript
<MaterialTable
  materials={formData.materials}
  employees={state.employees}
  onView={(material) => {
    setViewingMaterial(material);
    setViewModalOpen(true);
  }}
  onEdit={editMaterial}
  onDelete={removeMaterial}
  onAssigneeChange={(id, assigneeId) => {
    updateField("materials",
      formData.materials.map((m) =>
        m.id === id ? { ...m, assignee: assigneeId } : m
      )
    );
  }}
/>
```

STEP 6: ADD MISSING openSpecModal DEFINITION
==============================================
Before you use openSpecModal in hooks, you need to add this function at the beginning of the component, before the hook calls:

```javascript
const openSpecModal = (type) => {
  setSpecModalType(type);
  setSpecModalOpen(true);
};
```

Wait, this is actually defined in the useMaterialModal hook now, so after you get the hook, you use the openSpecModal returned from it.

STEP 7: VERIFY & TEST
=====================
After making these changes:
1. Run: npm run lint
2. Run: npm run build
3. Test the material form to ensure all functionality works

SUMMARY OF CHANGES:
===================
- Lines removed: ~435 lines of constants, state, and function definitions
- New imports: 3 hooks + 1 component + materialConstants
- MaterialTable component usage: 1 component replaces ~176 lines of table code
- Overall reduction: From 3,301 lines to approximately 2,700-2,800 lines

FILES CREATED:
==============
✓ constants/materialConstants.js - Material constants
✓ hooks/useMaterialForm.js - Form state and logic hook
✓ hooks/useMaterialModal.js - Modal state and logic hook
✓ components/MaterialTable.jsx - Material list table component
✓ utils/materialHelpers.js - Utility functions and constants
✓ REFACTORING_GUIDE.md - Detailed refactoring guide

NEXT PHASE (Optional):
======================
After completing the above refactoring, you can further split the spec modal code:
- Create modals/SpecModal.jsx - Wrapper modal component
- Create individual spec modal components for each material type
- Create modals/ViewMaterialModal.jsx - View details modal
